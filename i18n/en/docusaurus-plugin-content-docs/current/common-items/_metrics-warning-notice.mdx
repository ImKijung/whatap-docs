Home > Select Project > <Cmdname sid="event_statistic" className="uitext" /> > <Cmdname sid="event_setting" className="uitext" /> > Select <Cmdname sid="metrics" className="uitext" /> tab

## What is the metrics event?

Metrics events are used to set more specific and complex events than basic events (application events, server events, and such). You can set events based on the metrics data being collected in real time from your projects. Depending on the usage, you can set any event by selecting one of two methods.

-   Metrics Event
-   Composite metrics event

<Xclude product='npm'>

:::note

For more information about the metrics, see [the following](metrics-intro).

:::

</Xclude>

<InDoc product='npm'>

:::note

For more information about metrics, see [the following](../metrics/common-metrics-intro).

:::

</InDoc>

## Metrics Event

Select <Cmdname sid="metrics" className="uitext" /> on the screen in <Cmdname sid="event_statistic" className="uitext" /> &gt; <Cmdname sid="event_setting" className="uitext" />. Select <Cmdname sid="add_notification" className="uitext" /> on the upper right of the screen. The <Cmdname sid="metrics_event" className="uitext" /> window appears.

<ImgLang img='set-events-metrics.png' desc='Metrics Event' />

<InDoc product='kubernetes'>

:::note

For more information about the event templates for metrics, see [the following](#k8s-metrics-event-template).

:::

</InDoc>

### Entry of basic information{#basic-info}

-   <Cmdname sid="event_name" className="uitext" />: Enter the name of the event to add.

-   <Cmdname sid="enable_events" className="uitext" />: Select whether or not to activate events.

-   <Cmdname sid="template" className="uitext" />: Events can be easily set after selecting a template. If the template is not to be used, select <Cmdname sid="metrics_option_disabled" className="uitext" />.

    <InDoc product='java,php,nodejs,python,golang,dotnet,postgresql,postgresql-v1,browser,npm'>

    :::note

    For more information about the template list, see [the following](#template).

    :::

    </InDoc>

-   <Cmdname sid="category" className="uitext" />: The unit to identify the metrics data. It is a mandatory value for setting the metrics events.

    <ImgLang img='set-event-select-category.png' desc='Metrics Event - Category' />

    -   The <Cmdname sid="category" className="uitext" /> selection options display <LinkImage img="number-01.png" className="ico" /> <Cmdname sid="name" className="uitext" /> and <LinkImage img="number-02.png" className="ico" /> data collection interval, and <LinkImage img="number-03.png" className="ico" /> <Cmdname sid="key" className="uitext" />. When setting up an event, use the key value of the category.

    -   <Cmdname sid="category" className="uitext" /> retrieves metrics data being collected from projects within the last 3 hours and displays them in a list. If the collection interval is not displayed in the <Cmdname sid="category" className="uitext" /> selection options, you can select <Cmdname sid="enter_category_self" className="uitext" /> option to enter a category key.

-   <Cmdname sid="level" className="uitext" />

    -   It displays the alert level when an event occurs. The levels are <span class='vslow'>Critical</span>, <span class='slow'>Warning</span>, and <span style={{color:'#757575'}}>Info</span>. When setting the <span class='vslow'>Critical</span> and <span class='slow'>Warning</span> levels, the <Cmdname sid="resolved_event_notification" className="uitext" /> selection option is enabled.

    -   <Cmdname sid="resolved_event_notification" className="uitext" /><ScrollToLink anchor='scrollTo-resolve-event' />: You can set whether or not to send notifications when the occurred event's status is resolved. This function can be enabled or disabled by selecting the toggle button.

-   <Cmdname sid="message" className="uitext" />

    -   Enter a notification message to be displayed when events occur. By entering `${tag or field key}`, you can apply the variable to the message. The key to enter in the variable must be included in <Cmdname sid="category" className="uitext" /> of the selected metrics data. You can see the tags or field keys that can be entered in <Cmdname sid="sitemap" className="uitext" /> > <Cmdname sid="tag_count" className="uitext" />.

    -   If the ![Start icon](/img/ico-timing.svg) button is clicked, you can see the history of previously entered messages.

-   <Cmdname sid="alert_test" className="uitext" />

    By generating alerts based on the required items: <Cmdname sid="event_name" className="uitext" />, <Cmdname sid="category" className="uitext" />, <Cmdname sid="level" className="uitext" />, and <Cmdname sid="message" className="uitext" />, this function checks the messages.

    :::note

    To use a reception test, enter or select required items in <Cmdname sid="event_name" className="uitext" />, <Cmdname sid="category" className="uitext" />, <Cmdname sid="level" className="uitext" />, and <Cmdname sid="message" className="uitext" />.

    :::

-   <Cmdname sid="metrics_event_rules" className="uitext" />

    <ImgLang img='set-event-condition.png' desc='Event Rule' />

    By entering the ![Leader line 4](/img/number-04.png) field, ![Leader line 5](/img/number-05.png) operator selection, and ![Leader line 6](/img/number-06.png) threshold value, set the event rule.

-   <Cmdname sid="alert_object_filtering" className="uitext" />

    <ImgLang img='set-event-filtering.png' desc='Filtering event targets' />

    It filters the targets by entering the ![Leader line 7](/img/number-07.png) tag, ![Leader line 8](/img/number-08.png) operator selection, and ![Leader line 9](/img/number-09.png) filtering value. If no input, alerts are sent to all agents.

:::note

-   For available basic syntaxes and operators in <Cmdname sid="metrics_event_rules" className="uitext" /> and <Cmdname sid="alert_object_filtering" className="uitext" />, see <Link to="#condition-guide">the following</Link>.

-   For the <Cmdname sid="metrics_event_rules" className="uitext" /> and <Cmdname sid="alert_object_filtering" className="uitext" /> options, you can select <Cmdname sid="metrics_rule_select" className="uitext" /> or <Cmdname sid="metrics_rule_direct" className="uitext" />.

-   After the event setting is made, the option value is managed as the <Cmdname sid="metrics_rule_direct" className="uitext" /> option. Afterwards, if switched to the <Cmdname sid="metrics_rule_select" className="uitext" /> option, the option value can be initialized.

-   Upon entry of event occurrence conditions and targets, an error may occur, if you enter a field name that contains special characters (<code>~!@#$%^&*()_+=-[]`</code>) or begins with a number. In this case, select the <Cmdname sid="metrics_rule_direct" className="uitext" /> option and then enter values enclosing with curly brackets (<code>${}</code>) as shown in the following example:

    ```text
    ${4xxErrorType} == '401'
    ```

:::

### Notification setting {#set-receive-event}

<ImgLang img='set-event-receive.png' desc='Notification Setting' />

-   <Cmdname sid="number_of_event" className="uitext" />: For the selected period, if the events set in <Cmdname sid="metrics_event_rules" className="uitext" /> occur as many as the input, an alert is sent.

    :::note

    -   If the selected time is set to <Cmdname sid="metrics_option_disabled" className="uitext" />, an alert is sent only when the events occur consecutively as many as the input.
    -   If the option, <Cmdname sid="resolved_event_notification" className="uitext" /> is activated, it is recommended to select <Cmdname sid="metrics_option_disabled" className="uitext" /> as the selected time.
    -   In the <Cmdname sid="category" className="uitext" /> option, the collection cycle for the selected item is 5 seconds.

    :::

-   <Cmdname sid="event_pause" className="uitext" /><ScrollToLink anchor='scrollTo-event-pause' />: This option can prevent excessive alert notifications from happening. No alerts are sent for the selected period after the first alert notification is generated. In addition, they are not recorded in <Cmdname sid="event_history" className="uitext" />.

-   <Cmdname sid="related_category" className="uitext" />: You can set the related categories up to 5 and see them when checking notifications.

-   <Cmdname sid="event_tag" className="uitext" />: If this tag is selected, notifications can be sent to project members and 3rd-party plug-ins with the corresponding tags. If the event receiving tag is not selected, alerts are sent to all project members.

    :::note

    In <Cmdname sid="event_statistic" className="uitext" /> &gt; <Cmdname sid="event_receive_configuration" className="uitext" />, you can set the tags in project members and 3rd-party plug-ins.

    :::

### Testing event rules

<ImgLang img='set-event-test.png' desc='Alert Test' />

You can check how many alerts have occurred by enabling the event conditions you set for the selected time period. If you select Run, you can see the number of notifications, and the selected fields and thresholds are displayed on the chart when the event conditions are met.

## Composite metrics event

To use the <Cmdname sid="composite_metrics" className="uitext" />, you have to understand the following concepts:

<Xclude product='npm'>

-   [What is the metrics?](metrics-intro)

</Xclude>

<InDoc product='npm'>

-   [What is the metrics?](../metrics/common-metrics-intro)

</InDoc>

-   [MXQL](../mxql/mxql-overview)

The <Cmdname sid="composite_metrics" className="uitext" /> can generate events by using more complex rules along with the metrics data and send alerts. Composite metrics can be used effectively in the following situations:

-   You have to make comprehensive decisions on data received from multiple agents.
-   You have to compare the past data with the current ones to make judgment.

Metrics events make judgment whenever metrics are received from the agents. On the other hand, the composite metrics event stores the metrics collected from each agent into the database. Then they are reviewed to judge the event. Because of this characteristic, the data from multiple agents can be used collectively or the past data can be used. However, there is a barrier to entry that requires to use **_MXQL_**, the WhaTap's unique data query language. Therefore, event templates are provided so that users can effectively set events only if they understand the basic **_MXQL_**. Basic MXQL users can apply events by just modifying the query for event target filtering and conditions.

1.  Select <Cmdname sid="metrics" className="uitext" /> on the screen in <Cmdname sid="event_statistic" className="uitext" /> &gt; <Cmdname sid="event_setting" className="uitext" />.

2.  In the <Cmdname sid="composite_metrics" className="uitext" /> section, select <Cmdname sid="add_notification" className="uitext" /> on the right.

3.  If the <Cmdname sid="composite_metrics" className="uitext" /> window appears, select <Cmdname sid="create_new_composite_mxql_event" className="uitext" />.

The Event Setting window appears. 

<ImgLang img='set-event-cmetric.png' desc='Composite Metrics Event Setting' />

<Xclude product='server'>

:::note

To set a composite metrics event, you have to have the **_event setting_** role.

:::

</Xclude>

<InDoc product='server,postgresql,postgresql-v1,java,python,php,nodejs,golang,dotnet,browser'>

:::note

For more information about the event templates for composite metrics, see [the following](#composite-metrics-template).

:::

</InDoc>

### Query event data

The <Cmdname sid="composite_metrics" className="uitext" /> creates event conditions based on the metrics data query language, <b>MXQL</b>. The <Cmdname sid="create_new_composite_mxql_event" className="uitext" /> function provides a combo box function for automatic completion of <b>MXQL</b>. This template is used to query the event data, construct a chart, and then directly enter the event generation conditions. Set the event by selecting <Cmdname sid="widget" className="uitext" /> or <Cmdname sid="text" className="uitext" />.

<Tabs>
<TabItem value='widget' label='Widget'>

Through the option to configure the time series charts, you can autocomplete **MXQL** for using when setting events.

<ImgLang img='set-event-data-view.png' desc='Event data inquiry' />

-   <Cmdname sid="filter" className="uitext" />: Select an event condition target. Enter values for <LinkImage img="number-01.png" className="ico" /> formula, <LinkImage img="number-02.png" className="ico" /> tag, and <LinkImage img="number-03.png" className="ico" /> filtering values to create filtering conditions.

    <ImgLang img='set-event-cmetric-filter.png' desc='Filter' />

-   <Cmdname sid="groupby" className="uitext" />: Select the grouped metrics data. You can select multiple items.

-   <Cmdname sid="timeunit" className="uitext" />: Set the time criterion for dividing the grouped data. You can set it by selecting <Cmdname sid="second" className="uitext" />, <Cmdname sid="minute" className="uitext" />, and <Cmdname sid="hour" className="uitext" />.

-   <Cmdname sid="field" className="uitext" />: Select a field to use as an event generation condition. You can select multiple items.

</TabItem>
<TabItem value='text' label='Text'>

The editing window appears where you can modify **MXQL** in plain text.

<ImgLang img='set-event-metrics-text.png' desc='Metrics Event - Text' />

</TabItem>
</Tabs>

### Notification

Enter basic data for alert settings.

-   <Cmdname sid="enable_events" className="uitext" />: You can select to enable or disable the events by clicking the toggle button.

-   <Cmdname sid="level" className="uitext" />: Select a level among <span class='vslow'>Fatal</span>, <span class='slow'>Warning</span>, and <span style={{color: '#757575'}}>Info</span>.

    <Cmdname sid="resolved_event_notification" className="uitext" />: You can set whether or not to send notifications when the occurred event's status is resolved. This function can be enabled or disabled by selecting the toggle button.

-   <Cmdname sid="title" className="uitext" />: Enter the title of the alert.

-   <Cmdname sid="message" className="uitext" />: Enter the notification message displayed upon occurrence of events. By entering <code>&#36;&#123;tag or field key&#125;</code>, you can apply the variable to the message. The key to enter into the variable must be a value contained in the selected composite metrics data <Cmdname sid="category" className="uitext" />. You can see the tags or field keys that can be entered in <Cmdname sid="sitemap" className="uitext" /> &gt; <Cmdname sid="tag_count" className="uitext" />.

### Alert Policy

Enter the conditions to send alerts.

-   <Cmdname sid="data_time_range" className="uitext" />: Set the time range to view the <b>MXQL</b> real-time data for event conditions. You can use only the fields included for viewing the event data.

    Composite metrics events retrieve metrics in DB for later use. Therefore, first specify the time range to query data. If you select 5 minutes for the data lookup time, the event generation conditions are checked by searching for the data collected for the last 5 minutes. You can set it short when you set any event for recent data, or long when you want to approach statistically for a wide period. For an actual use case, see [the following](#template).

-   <Cmdname sid="condition" className="uitext" />: Enter the fields, calculation rules, and thresholds reflected in MXQL.

### Additional information

Set additional options that are related to receiving alerts.

-   <Cmdname sid="interval" className="uitext" />: Check the notification conditions at the selected time interval.

-   <Cmdname sid="silent" className="uitext" />: This option can prevent excessive alert notifications from happening. No alerts are sent for the selected period after the first alert notification is generated. In addition, they are not recorded in <Cmdname sid="event_history" className="uitext" />.

-   <Cmdname sid="event_tag" className="uitext" />: If this tag is selected, notifications can be sent to project members and 3rd-party plug-ins with the corresponding tags. If the event receiving tag is not selected, alerts are sent to all project members.

    :::note

    In <Cmdname sid="event_statistic" className="uitext" /> &gt; <Cmdname sid="event_receive_configuration" className="uitext" />, you can set the tags in project members and 3rd-party plug-ins.

    :::

### Test Event Rules

<ImgLang img='set-event-cmetric-test.png' desc='Testing event rules' />

You can check how many alerts have occurred by enabling the event conditions you set for the selected time period. If you select Run, you can see the number of notifications, and the selected fields and thresholds are displayed on the chart when the event conditions are met.

Most of what is included in Event Setting can be specified using **MXQL**. It provides the function to simulate whether **MXQL** has been properly written. The simulation function queries the past 24-hour data to make judgment, and then informs you how many metrics were queried and how many of them are successful.

## Modifying and deleting metrics events

1.  Go to <Cmdname sid="event_statistic" className="uitext" /> &gt; <Cmdname sid="event_setting" className="uitext" /> and then select the <Cmdname sid="metrics" className="uitext" /> tab.

2.  In the event list, select ![Edit icon](/img/ico-edit.svg) at the utmost right of the item to modify or delete.

3.  If the metrics or composite metrics event setting window appears, modify each option and then select <Cmdname sid="save" className="uitext" />.

  To delete the selected event, select ![Delete icon](/img/ico-trash.svg) <Cmdname sid="delete" className="uitext" /> on the upper right of the event setting window.

## Guide to select generation conditions and targets {#condition-guide}

For the event generation conditions and selection of event targets on metrics alerts, use the same syntaxes. For event generation conditions, use the tag key as a variable. For selection of event targets, use the field key as a variable.

### Basic syntax rules

-   If you just enter a string, it is recognized as a variable. If you enclose it in single quotation marks ('') or double quotation marks (""), it is recognized as text.

    ```java title='oid == "oid"'
    1. oid: variable
    2. ==: function
    3. "oid": text
    ```

    ```java
    // In case oname is ott-1235

    // Normal cases
    onname = 'ott-1235' or onname = "ott-1235"

    // In abnormal cases, notification does not work.
    onname = ott-1235
    ```

-   If you just enter a number, it is recognized as number, and if you enclose it in single quotation marks ('') or double quotation marks (""), it is recognized as text.

    ```java title='oid == 123'
    1. oid: variable
    2. ==: function
    3. 123: number
    ```

    ```java
    // In case oid is 123

    // Normal cases
    oid = 123

    // In abnormal cases, notification does not work.
    id == '123' or oid == "123"
    ```

### Available operators

|  Operator      | Usage                         | Description                                                                                                           |
| :------------: | ----------------------------- | --------------------------------------------------------------------------------------------------------------------- |
|    ==          | operand1 == operand2          | It checks whether operand1 is equal to operand2.                                                                      |
|    !=          | operand1 != operand2          | It checks whether operand1 and operand2 have different values.                                                        |
| <span>></span> | operand1 > operand2           | Check whether the operand1 value is greater than the operand2 value.                                                  |
|    > =         | operand1 >= operand2          | Checks whether the operand1 value is greater than or equal to the operand2 value.                                     |
|    \<          | operand1 \< operand2          | Check whether the operand1 value is less than the operand2 value.                                                     |
|    \<=         | operand1 \<= operand2         | Check whether the operand1 value is less than or equal to the operand2 value.                                         |
|    like        | operand1 like operand2        | Search with patterns whether operand1 includes operand2.                                                              |
|    &&          | expression1 && expression2    | Check whether expression1 and expression2 are all `true.`                                                             |
|    and         | expression1 and expression2   | Check whether expression1 and expression2 are all `true.`<br/>The operator plays the same role as **&&**.             |
|     ||         | expression1 || expression2    | Check whether expression1 and expression2 are all `true.`                                                             |
|    or          | expression1 or expression2    | Check whether expression1 and expression2 are all `true.`<br/>The operator plays the same role as **||**.             |

#### Usage of like

You can conveniently search for embedded strings via the wildcard (`*`).

-   Searching for strings that start with a specific keyword

    ```java

    Key like "Value*"

    ```

-   Searching for strings that end with a specific keyword

    ```java

    Key like "*Value"

    ```

-   Searching for strings that include a specific keyword

    ```java

    Key like "*Value*"

    ```

-   The wildcard (`*`) cannot be used in the middle of keywords.

    ```java

    // Unsupported syntax
    Key like "Va*lue"

    ```

-   If you omit the wildcard (`*`) in the `like` operator, it operates as equals (`==`).

    ```java

    // The following two statements have the same result.
    Key like "Value"
    Key == "Value"

    ```

### Available functions

| Method                    | Usage                      | Description                                                                                                      |
| ------------------------- | -------------------------- | ---------------------------------------------------------------------------------------------------------------- |
| [startsWith](#startwith)  | startsWith(param1, param2) | If the value whose param1 is the key starts with param2, the result is `true.` Otherwise, the result is `false.` |
| [endsWith](#endsWith)     | endsWith(param1, param2)   | If the value whose param1 is the key ends with param2, the result is `true.` Otherwise, the result is `false.`   |
| [isNull](#isnull)         | isNull(param1)             | If param1 is `null,` the value becomes `true'. Otherwise, the value becomes `false\`.                            |
| [isNotNull](#isnotnull)   | isNotNull(param1)          | If param1 is not `null`, the value becomes `true'. Otherwise, the value becomes `false\`.                        |
| [isEmpty](#isempty)       | isEmpty(param1)            | If param1 is `null` or `EmptyString("")`, the value becomes `true`. Otherwise, the value becomes `false`.        |
| [isNotEmpty](#isnotempty) | isNotEmpty(param1)         | If param1 is not `null` nor `EmptyString("")`, the value becomes `true`. Otherwise, the value becomes `false`.   |

#### startsWith {#startwith}

```java
startsWith(Key, "Value")
```

#### endsWith {#endswith}

```java
endsWith(Key, "Value")
```

#### isNull {#isnull}

```java
isNull(Key)
```

#### isNotNull {#isnotnull}

```java
isNotNull(Key)
```

#### isEmpty {#isempty}

```java
isEmpty(Key)
```

#### isNotEmpty {#isnotempty}

```java
isNotEmpty(Key)
```
