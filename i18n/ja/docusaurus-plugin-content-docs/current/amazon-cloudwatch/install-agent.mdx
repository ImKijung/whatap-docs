---
id: install-agent
title: インストール
description: Amazon CloudWatchアイテムのインストールについて説明します。
tags:
  - インストール
  - Amazon CloudWatch
  - クラウド
---

import TR from '@site/src/components/TR';
import ProdImg from '@site/src/components/ChangeImgName.js';

WhaTap Amazon CloudWatchモニタリングはAPI連動を通じてメトリックを周期的に収集します。 収集を希望するサービスに該当するCloudWatchネームスペースで、5分おきに希望するスタットを炊事選択して収集します。モニタリングを開始する時、すべてのリージョンのユーザーリソースを検索し、ワンクリックでモニタリングを開始できます。Role方式認証で安全かつ便利に使用できます。 

import Createprojectcloud from "../getting-started/_create-project-cloud.mdx";

<Createprojectcloud />

## チェックリスト

必要なアクセス権限と推奨されるポリシーを確認してください。

| Resouce          | 権限   |
| ---------------- | ---- |
| CloudWatch       | Read |
| EC2              | Read |
| ElasticCache     | Read |
| CloudFront       | Read |
| Dynammodb        | Read |
| ElasticBeansTalk | Read |
| AutoScaling      | Read |
| EFS              | Read |
| RDS              | Read |

- **推奨ポリシー**
  - arn:aws:iam::aws:policy/ReadOnlyAccess

## モニタリング手順

1. Amazon認証情報を入力してください。
2. CloudWatchネームスペースおよび収集サイクルを選択してください。
3. リージョン、メトリクス、統計などを選択してください。

:::note

インストール後の使用状況によっては、WhaTap料金とは別にクラウドで追加費用が発生する場合があります。インストール前に使用しているクラウドサービスの価格ポリシーを[次の文書](https://aws.amazon.com/ko/cloudwatch/pricing/)で確認してください。

:::

### 認証情報入力

Role ARNを利用したインストール方法をサポートします。 WhaTap AWSアカウント(**911937781722**)は、直接ユーザーRoleをAssumeしてCloudwatch情報を収集します。Role Assumeはアクセスキーの発行を必要としないため、安全で便利です。

:::note

Roleを使用して設定をお勧めします。 Access Keyの使用は、既存のAccess Keyのユーザーのみ可能です。

:::

#### ロール(Role) 生成

<ImgLang img='cloudwatch-auth-role.png' desc='Amazon Cloudwatch - role' />

1. AWS Management Consoleにログインしてから、IAMコンソールを開きてください。
2. コンソールナビゲーションウィンドウでロールを選択し、ロールの作成を選択してください。 
3. 信頼できるエンティティタイプ(Select type of trusted entity)でAWSアカウントを選択してください。 
4. 他のAWSアカウントを選択し、アカウントIDにWhaTapのIDである**911937781722**を入力して、次へをクリックしてください。
5. フィルタリング基準タイプでAWS管理型職務を選択してください。 
6. 一覧でReadOnlyAccessのチェックボックスを選択して適用し、次へをクリックしてください。 
7. 役割(Role)の名前と説明を入力し、役割作成(Create Role)ボタンをクリックしてください。 
8. 役割一覧で作成した役割を選択し、サマリー(Summary)の編集ボタンをクリックしてください。 
9. 最大セッション持続時間(Maximum session duration) 項目を12時間に変更して保存してください。 
10. **Role ARN**項目をコピーしてください。
11. WhaTap**_管理_** > **_エージェントのインストール_** ページに戻り、**_Role_** **_ARN_**ウィンドウにコピーした**RoleARN**を貼り付け、**_確認_**ボタンをクリックしてください。

### ネームスペースおよび収集サイクルの選択

import Namespacecollect from "../common-items/_namespace-collect.mdx";

<Namespacecollect />

#### WhaTapの収集周期

import Collectingperiod from "../common-items/_collecting-period.mdx";

<Collectingperiod />

#### ネームスペース

- AWS ACMPrivateCA
- AWS AmazonMQ
- AWS ApplicationELB Monitoring
- AWS AppSync
- AWS Athena
- AWS AutoScaling
- AWS Elastic Beanstalk Health
- AWS Billing
- AWS Cassandra
- AWS Chatbot
- AWS Cloud Front
- AWS CloudHSM
- AWS CloudSearch
- AWS CodeBuild
- AWS CodeGuruProfiler
- AWS Cognito
- AWS Connect
- AWS ContainerInsights Monitoring
- AWS DataSync
- AWS DAX
- AWS DDoSProtection
- AWS DMS
- AWS DocDB
- AWS DX
- AWS Dynamo DB
- AWS Ebs Usage
- AWS EC2 Monitoring
- AWS EC2 Alert Config
- AWS EC2Spot
- AWS ECS
- AWS EFS
- AWS ElastiCache Usage
- AWS ElasticGPUs
- AWS ElasticInference
- AWS ElasticMapReduce
- AWS ElasticTranscoder
- AWS Classic ELB Monitoring
- AWS ES
- AWS Events
- AWS Firehose
- AWS FSx
- AWS GameLift
- AWS GatewayELB
- AWS Glue
- AWS GroundStation
- AWS Health
- AWS Inspector
- AWS IoT
- AWS IoTAnalytics
- AWS IoTSiteWise
- AWS IVS
- AWS Kafka
- AWS Kinesis
- AWS KinesisAnalytics
- AWS KinesisVideo
- AWS KMS
- AWS Lambda
- AWS Lex
- AWS Location
- AWS Logs
- AWS LookoutMetrics
- AWS MediaConnect
- AWS MediaConvert
- AWS MediaPackage
- AWS MediaStore
- AWS MediaTailor
- AWS ML
- AWS NATGateway
- AWS Neptune
- AWS NetworkELB
- AWS NetworkFirewall
- AWS OpsWorks
- AWS Polly
- AWS QLDB
- AWS RDS Monitoring
- AWS Redshift
- AWS Robomaker
- AWS Route53
- AWS S3
- AWS SageMaker
- AWS SDKMetrics
- AWS ServiceCatalog
- AWS SES
- AWS SNS
- AWS SQS
- AWS SQS Message
- AWS SSM-RunCommand
- AWS States
- AWS StorageGateway
- AWS SWF
- AWS Textract
- AWS ThingsGraph
- AWS Timestream
- AWS Transfer
- AWS TransitGateway
- AWS Translate
- AWS TrustedAdvisor
- AWS Api Usage
- AWS VPN Monitoring
- AWS WAF
- AWS WorkMail
- AWS WorkSpaces

### リージョン、メトリクス、統計を選択

import Regionmetricstats from "../common-items/_region-metric-stats.mdx";

<Regionmetricstats />

<ImgLang img='amazon_cloudwatch_setup_dialog_2nd.png' desc='Amazon Cloudwatch - Region,Metric,Stats' />

## データ収集の無効化及びサービス初期化 {#data-deactivation}

<ImgLang img='amazon-cloudwatch-deact.png' desc='データ収集の無効化及びサービス初期化' />

- ![指示線a](/img/char-a.svg)収集トグル![アイコン](/img/ic-toggle-off.svg)無効化した場合、データ収集が中止されます。

- ![指示線b](/img/char-b.svg)**_役割(Role)の変更_**ボタンをクリックし、**_エージェントのインストール_**画面で![指示線c](/img/char-c.svg)**_サービスの初期化_**を選択すると、メトリクスを収集中のすべてのサービスを無効化します。

- 完全に費用発生を防止するためには、**AWS IAM**コンソールから**役割**(Role)を削除する必要があります。
