---
id: set-db-metric-warning-notice
title: DBメトリックアラート通知設定
description: データベースサービスのメトリクスアラート通知の設定方法をご案内します。
tags:
  - データベース
  - メトリックス
  - アラート通知
---

データベースプロジェクトのメトリクスアラート通知の設定方法をご案内します。 データベースの性能に関する主要指標に基づいて通知を設定し、発生しうる問題状況を迅速に認識することができます。

## プロセス(process)アラート通知の設定

データベースを運用していると、プロセスが突然と終了する場合があります。 データベースで実行中のプロセスが終了した場合、ユーザーにアラート通知を送信して問題状況に迅速に対処できます。 

### XOSエージェント設定

メトリクスイベントを追加する前に、XOSエージェント設定(_xos.conf_)に次のオプションを追加してください。 次の例は**top**と**lock.sh**プロセスをモニタリング対象に設定する場合です。 コンマ(、)を区切り文字として利用し、複数のプロセスを登録できます。

```ini title='xos.conf'
process=top,lock.sh
```

### メトリクスイベントの追加

XOSエージェント(_xos.conf_)で設定したプロセスモニタリング対象が終了した場合、アラート通知を送信するように設定する場合の例です。

1.  ユーザーのデータベースプロジェクトで**_アラート通知_**>**_イベント設定_**メニューに移動してください。

2.  **_メトリクス_**タブを選択してください。

3.  **_+イベント追加_**ボタンを選択してください。

4.  **_メトリクスイベント_**ウィンドウが表示されたら**_イベント名_**を入力してください。

5.  **_カテゴリ_**で**_db_process_check_**項目を選択してください。

    <ImgLang img='best-p/db-add-metrics-event-category-process.png' />

6.  **_レベル_**で通知レベルを選択してください。

7.  **_メッセージ_**でアラート通知メッセージを入力してください。 タグまたはフィールドキー入力でメッセージに変数を適用できます。 

    (例、`${oname}`、`${count}`、`${process_name}`)

8.  次の事例のうち、希望する値を**_イベント発生条件_**に入力してください。

    -   **top**プロセスまたは**lock.sh**プロセスが１つでも終了した場合: `process_name == 'top' || process_name == 'lock.sh'`

        <ImgLang img='best-p/db-add-metrics-event-category-process-sample-00.png' />

    -   xos.confファイルで設定したプロセスモニタリング対象のうち、２つ以上が終了した場合: `count >= 2`

        <ImgLang img='best-p/db-add-metrics-event-category-process-sample-01.png' />

    -   xos.confファイルで設定したプロセスモニタリング対象のうち、２つ以上が終了したりlock.shプロセスが終了した場合: `process_name == 'lock.sh' || count >= 2`

        <ImgLang img='best-p/db-add-metrics-event-category-process-sample-02.png' />

9.  すべての入力が完了したら、**_保存_**ボタンを選択してください。

:::note

-   イベントの状態が解消された場合、通知を希望する場合は**_イベント状態が解決されたら追加で通知する_**オプションを選択してください。

-   タグまたはフィールドキー**_サイトマップ_**>**_メトリクス照会_**メニューで確認することができます。

-   データベースプロジェクトの**メトリクスアラート通知**の詳細については、[次の文書](../postgresql/metric-warning-notice)を参照してください。

:::
