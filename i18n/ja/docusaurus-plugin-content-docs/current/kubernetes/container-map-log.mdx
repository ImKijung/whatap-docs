---
id: container-map-log
title: Log
description: コンテナまたはコンテナ内部で実行中のアプリケーションが出力するログをすぐに確認できます。
tags:
  - Kubernetes
  - Kubernetesモニタリング
  - Log
---

ホーム画面 > プロジェクト選択 > **_ダッシュボード_** > **_コンテナマップ_** > 対象選択後**詳細を見る**画面に進入 > **_ログ_**

## Kubernetesログ

와탭 쿠버네티스 모니터링 서비스는 쿠버네티스에서 발생하는 로그를 수집하고 저장합니다. 

<!-- 

실시간으로 발생하는 로그는 컨테이너 ***Stdout/Stderr*** 탭의 최근 로그 메시지와 ***로그 검색*** 탭을 통해 조회할 수 있습니다. >

-->

Kubernetesには、次の2種類のログがあります。

-   各コンテナのStandard Out（標準出力）ログ
-   各コンテナの内部で実行中のアプリケーションが出力するログ

このようなログは、コンテナの状態やメトリクス情報では確認しにくいモニタリングの死角地帯を補完する役割を果たします。このログを確認する方法は次のとおりです。

-   各コンテナのStandard Outログの場合は、コンテナ内部に進入しなくてもKubernetesが提供する`kubectl logs`コマンドで確認できます。
-   各コンテナ内部のアプリケーションログは、コンテナ内部に進入して確認するか、別途のログ収集方法を策定する必要があります。

## 最近のログメッセージ （コンテナStdout／Stderr）

현재 컨테이너 로그를 바로 확인할 수 있는 기능입니다. 사용자의 클러스터 환경에서 직접 로그를 가져와 선택한 컨테이너의 실시간 로그 또는 선택한 Pod 내 애플리케이션의 실시간 로그를 확인할 수 있습니다. 일반적으로 컨테이너 로그를 확인하기 위해서는 다음 명령어를 사용합니다.

```bash
kubectl logs pod/<Pod名> -n <Namespace名>
```

Pod内に2つ以上のコンテナが存在する場合は、個々のコンテナを選択してログを確認します。

```bash
kubectl logs pod/<Pod名> -c <コンテナ名> -n <Namespace名>
```

ログを確認するために毎回ターミナル画面にアクセスしてコマンドラインツールを実行するのは非常に不便です。WhaTap Kubernetesモニタリングの**_ログ_**機能を使用すると、現在のログを便利に確認できます。 

![最近ログメッセージ](/img/k8s-container-log.png)

ただ、注意点があります。まず、コンテナを終了すると、ログを確認できなくなります。また、コンテナが継続して実行中であっても、一定期間または一定容量のログだけを確認できるというデメリットがあります。WhaTapの最近のログメッセージ(**_コンテナStdout/Stderr_**) 機能は、ユーザーKubernetes環境のログをWhaTapを通じて確認できるように提供する機能であり、ユーザー環境から消えたログは、WhaTapでも確認できません。 

したがって、ログデータを安定的かつ継続的に管理するためには、別途の管理策が不可欠です。特にマイクロサービスアーキテクチャの導入が広がり、ビジネスを構成するコンテナ数量が増加するにつれてログの確認、管理策はさらに複雑になりつつあります。

いい方法があるでしょうか？

## ログ検索

컨테이너 종료 시 관련 로그가 모두 사라지지만 **_로그 검색_** 기능을 통해 선택한 컨테이너 또는 Pod에서 과거에 발생한 로그를 확인할 수 있습니다. 컨테이너 Standard Out 로그 저장 시 원하는 만큼 저장 기간을 설정할 수 있고 특정 대상별 정보를 확인하거나 상호 연계 분석을 할 수 있습니다. 

![ログ検索](/img/k8s-log-search.png)

-   ![number 1](/img/number-01.png) 시간 선택자를 통해 데이터 조회를 원하는 시점을 선택할 수 있습니다. 

-   ![number 2](/img/number-02.png) 카테고리를 지정해 조회할 수 있습니다. 조회할 수 있는 카테고리에 대한 설명은 다음의 블록과 그룹 안내를 참조하세요.

-   ![number 3](/img/number-03.png) ![더보기 아이콘](/img/ic-caret-right.svg) **_더보기_** 아이콘을 선택하면 해당 로그의 파싱된 키와 값 및 로그 메시지를 확인할 수 있습니다. 자세한 내용은 [다음 문서](../log/log-search)를 참조하세요.

#### 일반 블록과 마이크로 블록

![컨테이너 블록 sc](/img/k8s-block.png)

-   ![a 아이콘](/img/char-a.svg) **일반 블록**

    컨테이너 맵의 다각형 하나를 블록이라고 합니다. 로그의 `containerStdout` 카테고리에서 `containerid` 가 일치하는 정보를 확인할 수 있습니다.

-   ![b 아이콘](/img/char-b.svg) **마이크로 블록**

    에이전트가 설치된 블록을 마이크로 블록이라고 합니다. `containerStdout` 카테고리 뿐 아니라 `AppLog`, `AppStdOut`, `AppStdErr` 등 `App*` 관련 카테고리도 확인할 수 있습니다. 해당 카테고리를 선택할 경우 `microOid`(블록 내 에이전트 id)가 일치하는 로그 정보를 확인할 수 있습니다.

#### グループ

![컨테이너 블록 그룹 sc](/img/k8s-container-group.png)

**_컨테이너 맵_** 화면에서 전체 블록을 선택한 경우 혹은 **상세 보기** 화면의 카드에서 블록을 다중 선택한 경우 해당 다중 블록을 그룹이라고 합니다. 그룹 선택 시 **_로그 검색_** 탭에서 `containerStdout` 카테고리와 `App*` 카테고리의 모든 로그를 확인할 수 있습니다.

:::caution

WhaTapログサービスを活性化してコンテナのStandard Outputログ保存機能を使用すると、それに伴う追加費用が請求されます。関連する料金の詳細については、[次の文書](https://www.whatap.io/ko/pricing/)を参考にしてください。

:::

:::note

一部の旧バージョンエージェントの場合は、コンテナStandard Outputを通じたログ保存機能を提供しません。エージェントのアップグレード方法は次のとおりです。

```bahs title='Agent update'
kubectl set image daemonset/whatap-node-agent whatap-node-agent=whatap/kube_mon:<エージェントバージョン> -n whatap-monitoring
```

WhaTap Kubernetesエージェントバージョンについては、 [次の文書](https://hub.docker.com/r/whatap/kube_mon/tags)で確認できます。

:::

### Standard Out保存のためのNodeエージェント設定の追加

WhaTapログサービスを通じてコンテナのStandard Outputを保存するためには、WhaTap Kubernetes Nodeエージェントに`logsink_enabled=true`設定を追加する必要があります。WhaTap Kubernetes NodeエージェントはDaemonSet形式です。

-   WhaTapモニタリングサービスページで**_管理_** > **_エージェント設定_**を通じて、`logsink_enabled=true`設定を追加
-   クラスタープロジェクトの全体ノードを対象に設定を追加するには、**_プロジェクトデフォルト_** > **_Node_**を対象に設定を追加
-   一部のNodeを対象に設定を追加するには、単一または複数のNodeを選択した後に設定を追加

**_管理_** > **_エージェント設定_** > Nodeエージェント選択 > **_+ オプション追加_** > すべてのエージェントに適用するオプションを選択 > 適用対象Node選択 

![エージェント設定](https://img.whatap.io/media/images/whatap_kubernetes_container_map_logsink_enabled.png)

## ログ検索移動

![로그 검색 이동 sc](/img/k8s-log-search-to-log-search.png)

**_로그_** 탭 오른쪽에 **_로그 검색_** 버튼을 클릭하면 필터 기능 등을 통해 상세 조회할 수 있는 **_로그_** > **_로그 검색_** 메뉴로 이동합니다. 

:::note

WhaTapログモニタリングサービスの詳細については、[次の文書](../log/introduction)を参考にしてください。 

:::

<!-- 

로그 검색 이동 제거 예정

-->
