---
id: metrics-data-list
title: PostgreSQLメトリクス
description: PostgreSQLデータベースのメトリクスについて案内します。
tags:
  - PostgreSQL
  - メトリックス
  - データベース
  - データベースモニタリング
---

import Note from '../common-items/_import_v2-note.mdx';

<Note product='PostgreSQL' link='../postgresql-v1/metrics-data-list' />

データベースメトリクスは、データベースの作業量とリソース使用量を包括的に収集します。 WhaTapモニタリングサービスは、継続的にメトリクスを収集してデータベースのボトルネックを確認し、性能問題の根本原因を識別するのに役立つデータを提供します。

その他メトリクスに関する詳細については、[次のリンク](https://www.postgresql.org/docs)を参考にしてください。

| メトリックス                  |      単位     | 説明                                                                                                                                                                                                         | カテゴリ        |
| ----------------------- | :---------: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------- |
| `active_sessions`       |      -      | クエリを実行する合計接続数                                                                                                                                                                                              | Connection  |
| `blk_read_time`         | millisecond | バックエンドでデータファイルブロックを書き込むのにかかった時間                                                                                                                                                                            | I/O         |
| `blk_write_time`        | millisecond | バックエンドでデータファイルブロックを書き込むのにかかった時間                                                                                                                                                                            | I/O         |
| `blks_hit`              |      -      | ディスクブロックはすでにバッファキャッシュで発見されており、読み取りを必要としない合計回数                                                                                                                                                              | I/O         |
| `blks_hit_ratio`        |     pct     | バッファキャッシュ的中率を意味します。 sum(`blks_hit`)/sum(`blks_hit`+`blks_read`)\*100で求めることができます。                                                                                                                           | I/O         |
| `blks_read`             |      -      | このデータベースで読み込んだディスクブロック数の合計数                                                                                                                                                                                | I/O         |
| `buffers_checkpoint`    |      -      | checkpointerプロセスが記録したバッファの総数                                                                                                                                                                               | Info        |
| `check_point`           |      -      | checkpointが実行された回数                                                                                                                                                                                         | Troughput   |
| `checkpoint_write_time` | millisecond | チェックポイント作業で発生したディスク書き込み作業のミリセカンド合計時間。                                                                                                                                                                      | Troughput   |
| `checkpoints_timed`     |      -      | `checkpoint_timeout`環境設定値に応じたチェックポイント作業の回収                                                                                                                                                                 | Troughput   |
| `commit_count`          |      -      | コミットされたこのデータベースのトランザクション数                                                                                                                                                                                  | Troughput   |
| `conflicts`             |      -      | データベース復旧作業と衝突して実行がキャンセルされたクエリ数                                                                                                                                                                             | Troughput   |
| `connect_error`         |      -      | エージェントがデータベース接続に失敗した場合にカウントされる数                                                                                                                                                                            | Connection  |
| `deadlock_count`        |      -      | 対応するデータベースで検出されたデッドロック状態の合計数                                                                                                                                                                               | Performance |
| `dml_count`             |      -      | dml実行数                                                                                                                                                                                                     | Troughput   |
| `index_hit_ratio`       |     pct     | indexをbuffer cacheで読み込んだ割合                                                                                                                                                                                 | Performance |
| `lock_wait_sessions`    |      -      | lockを待機するセッション数                                                                                                                                                                                            | Performance |
| `long_running_sessions` |      -      | long running time(default :10秒)以上実行中のセッション数                                                                                                                                                                | Performance |
| `max_connections`       |      -      | 最大接続可能数で、`pg_settings`に設定された値です。 足りなければ、'FATAL ERROR: too many clients already.' エラーが発生する可能性があります。                                                                                                         | Info        |
| `node_state`            |      -      | Replication関係で構成されたデータベースであり、`1`: Master、`2`: Slaveを意味する                                                                                                                                                   | Info        |
| `numbackends`           |      -      | 接続されたバックエンド数                                                                                                                                                                                               | Info        |
| `replication_count`     |      -      | Replication データベース(Slave)のカウント                                                                                                                                                                             | Performance |
| `replication_delay`     |      -      | Replication構造の場合、replicationデータベースに反映される遅延時間、Slave DBで測定されるメトリクス                                                                                                                                           | Performance |
| `rollback_count`        |      -      | ロールバックされたこのデータベースの合計トランザクション数                                                                                                                                                                              | Performance |
| `table_hit_ratio`       |      -      | tableをbuffercacheで読み込んだ割合                                                                                                                                                                                  | Performance |
| `temp_bytes`            |      -      | 該当データベースのクエリによって臨時ファイルに記録された総データ量                                                                                                                                                                          | Performance |
| `temp_files`            |      -      | そのデータベースでクエリとして生成されたファイル総数                                                                                                                                                                                 | Performance |
| `total_runtime`         |      -      | すべてのactive sessionらのruntime(elapse time)の合計                                                                                                                                                                | Performance |
| `total_sessions`        |      -      | 現在接続されているセッションの総数                                                                                                                                                                                          | Connection  |
| `tup_deleted`           |      -      | 該当データベースからクエリによって削除された合計行数                                                                                                                                                                                 | Troughput   |
| `tup_fetched`           |      -      | 該当データベースからクエリに読み込まれた合計行数                                                                                                                                                                                   | Troughput   |
| `tup_inserted`          |      -      | 該当データベースからクエリによって挿入された合計行数                                                                                                                                                                                 | Troughput   |
| `tup_returned`          |      -      | 該当データベースのクエリから戻された行数                                                                                                                                                                                       | Troughput   |
| `tup_updated`           |      -      | 該当データベースでクエリによってアップデートされた合計行数                                                                                                                                                                              | Troughput   |
| `vacuum_running_count`  |      -      | 現在vacuum処理が回っているプロセス数                                                                                                                                                                                      | Performance |
| `wait_sessions`         |      -      | 待機接続の総数                                                                                                                                                                                                    | Performance |
| `seq_scan`              |      -      | テーブルをFull Scanしながらレコードを読む方式<br/>インデックスが存在しないか、インデックスが存在しても読むべき範囲が広い場合に選択します。 このメトリクスは、1分ごとに照会した値です。                                                                                                        | Performance |
| `idx_scan`              |      -      | インデックスLeafブロックに保存されたキーを利用して、テーブルレコードにアクセスする方式、このメトリクスは1分ごとに照会した値です。                                                                                                                                        | Performance |
| `wal`                   |      -      | WALファイル個数。 WALファイル数の急増は、一般的に短期間で大量の変更や仮テーブルおよびオブジェクトを生成するvacuumと類似したメンテナンス作業によって発生します。 これはゆっくりと正常レベルに戻る必要があります。 これにより、一般的に多くのディスクI/OおよびCPU活動が発生し、状況が正常に戻るまでアプリケーションクエリの実行速度が遅くなります。 このメトリクスは、1分ごとに照会した値です。 | Performance |
| `cpu(xos2)`             |     pct     | cpu使用率、`cpu_user`+`cpu_sys`+`cpu_iowait`の合計                                                                                                                                                                | XOS         |
| `cpu_user(xos2)`        |     pct     | cpuがユーザーコードを実行するのに費やした時間                                                                                                                                                                                   | XOS         |
| `cpu_sys(xos2)`         |     pct     | cpuがkernel codeを実行した時間                                                                                                                                                                                     | XOS         |
| `cpu_iowait(xos2)`      |     pct     | cpuがIOを待機した時間                                                                                                                                                                                              | XOS         |
| `cpu_idle(xos2)`        |     pct     | cpuプロセッサアイドルタイム                                                                                                                                                                                            | XOS         |
| `mem(xos)`              |     pct     | メモリ使用率                                                                                                                                                                                                     | XOS         |
| `mem_total(xos)`        |      MB     | 全メモリ量                                                                                                                                                                                                      | XOS         |
| `mem_free(xos)`         |      MB     | システムで使用していないメモリ量                                                                                                                                                                                           | XOS         |
| `mem_used(xos)`         |      MB     | システムで使用しているメモリ量                                                                                                                                                                                            | XOS         |
| `mem_buffcache(xos)`    |      MB     | buff/cacheで使用中のメモリ量                                                                                                                                                                                        | XOS         |
| `mem_swaptotal(xos)`    |      MB     | Swap全体サイズ、物理メモリが不足している場合に備えて設定します。                                                                                                                                                                         | XOS         |
| `mem_swapfree(xos)`     |      MB     | Swapの未使用領域、Swap領域はディスク空間に確保されるため、Swapを使用しているとシステム性能が急激に低下する可能性があります。                                                                                                                                       | XOS         |
| `mem_available(xos)`    |      MB     | メモリ可用領域                                                                                                                                                                                                    | XOS         |
| `disk_reads(xos)`       |    block    | ディスクから読み込んだデータの量                                                                                                                                                                                           | XOS         |
| `disk_read_bytes(xos)`  |     バイト     | ディスクから読み込んだデータの量                                                                                                                                                                                           | XOS         |
| `disk_writes(xos)`      |    block    | ディスクで書き込まれたデータの量                                                                                                                                                                                           | XOS         |
| `disk_write_bytes(xos)` |     バイト     | ディスクで書き込まれたデータの量                                                                                                                                                                                           | XOS         |
| `net_recv_bytes(xos)`   |     バイト     | ネットワークで受信されたデータの量                                                                                                                                                                                          | XOS         |
| `net_recv_packets(xos)` |      -      | ネットワークで受信されたデータパケットの数                                                                                                                                                                                      | XOS         |
| `net_send_bytes(xos)`   |     バイト     | ネットワークに送信したデータの量                                                                                                                                                                                           | XOS         |
| `net_send_packets(xos)` |      -      | ネットワークに送信したデータパケットの数                                                                                                                                                                                       | XOS         |
