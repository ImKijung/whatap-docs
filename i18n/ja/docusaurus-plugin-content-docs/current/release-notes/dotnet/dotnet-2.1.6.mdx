---
id: dotnet-2_1_6
title: .NET Agent v2.1.6
toc_max_heading_level: 2
pagination_next: release-notes/dotnet/dotnet-2_1_5
---

2023年10月5日

-   <Status>Feature</Status>HTTP request body追跡機能の追加

    -   **profile_http_body_enabled** <span class='type'>Boolean</span>

        デフォルト値`false`

        HTTP requestのbodyをトレース履歴に記録します。

    -   **profile_http_body_url_prefix** <span class='type'>String</span>

        トレース履歴にhttp body情報を記録する対象URLのprefixを定義するときに使用します。

-   <Status>Feature</Status>ユーザーログ追跡機能の追加

    トレース履歴にユーザーが直接ログメッセージを残すことができる機能です。 ログを残すには、次のステップを進めてください。

    -   ログを残そうとするプロジェクトにCSファイルを追加し、コードを作成してください。

        ```csharp
        using System;

        namespace Whatap.UserLog
        {
            public static class Tracer
            {
                public static void Trace(string message)
                {
                    // コンパイラー最適化によりメソッド呼び出しが取り消されるのを防止
                    // このメソッド内のコードはWhatapエージェントによって無視されるため、実行されません。
                    Console.WriteLine(message);
                }
            }
        }
        ```

    -   ログを残したい位置で`Tracer.Trace("ログ文字列")`と同じ形式でコードを追加してください。

        ```csharp
        public string UserFunction(int value)
        {
            Tracer.Trace($"started... {value}");
            ...
        }
        ```

-   <Status>Fixed</Status>Windows Communication Foundation(WCF, ウェブサービス)関連エラーの修正

    `webservice_method_prefix`オプションが`null`文字列状態で`webservice_method_enabled=true`で設定すると、追跡対象がWCFを含むすべてのメソッドに拡大され、モニタリングできない対象が含まれるバグを修正しました。
